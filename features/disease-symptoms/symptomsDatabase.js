// Disease Symptoms Database and Checker
// Comprehensive symptom analysis for rural healthcare

const diseaseDatabase = {
  // Common Diseases with Symptoms
  fever: {
    name: {
      en: "Fever",
      hi: "рдмреБрдЦрд╛рд░",
      te: "р░Ьр▒Нр░╡р░░р░В"
    },
    symptoms: [
      "high temperature", "body ache", "headache", "chills", "sweating", 
      "weakness", "loss of appetite", "nausea"
    ],
    severity: "medium",
    urgency: "monitor",
    advice: {
      en: `**Fever Management:**
ЁЯМбя╕П **Immediate Care:**
тАв Rest and drink plenty of fluids
тАв Take paracetamol as per dosage
тАв Use cold compress on forehead
тАв Wear light clothing

тЪая╕П **See doctor if:**
тАв Temperature above 103┬░F (39.4┬░C)
тАв Fever lasts more than 3 days
тАв Severe headache or neck stiffness
тАв Difficulty breathing
тАв Persistent vomiting

ЁЯПа **Home Remedies:**
тАв Tulsi tea with honey
тАв Ginger and turmeric water
тАв Light, easily digestible food
тАв Adequate rest in ventilated room`,
      hi: `**рдмреБрдЦрд╛рд░ рдХрд╛ рдкреНрд░рдмрдВрдзрди:**
ЁЯМбя╕П **рддрддреНрдХрд╛рд▓ рджреЗрдЦрднрд╛рд▓:**
тАв рдЖрд░рд╛рдо рдХрд░реЗрдВ рдФрд░ рдЦреВрдм рддрд░рд▓ рдкрджрд╛рд░реНрде рдкрд┐рдПрдВ
тАв рдЦреБрд░рд╛рдХ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдкреИрд░рд╛рд╕рд┐рдЯрд╛рдореЛрд▓ рд▓реЗрдВ
тАв рдорд╛рдереЗ рдкрд░ рдардВрдбреА рдкрдЯреНрдЯреА рд░рдЦреЗрдВ
тАв рд╣рд▓реНрдХреЗ рдХрдкрдбрд╝реЗ рдкрд╣рдиреЗрдВ

тЪая╕П **рдбреЙрдХреНрдЯрд░ рд╕реЗ рдорд┐рд▓реЗрдВ рдпрджрд┐:**
тАв рддрд╛рдкрдорд╛рди 103┬░F (39.4┬░C) рд╕реЗ рдКрдкрд░
тАв рдмреБрдЦрд╛рд░ 3 рджрд┐рди рд╕реЗ рдЕрдзрд┐рдХ рд░рд╣реЗ
тАв рдЧрдВрднреАрд░ рд╕рд┐рд░рджрд░реНрдж рдпрд╛ рдЧрд░реНрджрди рдореЗрдВ рдЕрдХрдбрд╝рди
тАв рд╕рд╛рдВрд╕ рд▓реЗрдиреЗ рдореЗрдВ рдХрдард┐рдирд╛рдИ
тАв рд▓рдЧрд╛рддрд╛рд░ рдЙрд▓реНрдЯреА

ЁЯПа **рдШрд░реЗрд▓реВ рдЙрдкрдЪрд╛рд░:**
тАв рд╢рд╣рдж рдХреЗ рд╕рд╛рде рддреБрд▓рд╕реА рдХреА рдЪрд╛рдп
тАв рдЕрджрд░рдХ рдФрд░ рд╣рд▓реНрджреА рдХрд╛ рдкрд╛рдиреА
тАв рд╣рд▓реНрдХрд╛, рдЖрд╕рд╛рдиреА рд╕реЗ рдкрдЪрдиреЗ рд╡рд╛рд▓рд╛ рднреЛрдЬрди
тАв рд╣рд╡рд╛рджрд╛рд░ рдХрдорд░реЗ рдореЗрдВ рдкрд░реНрдпрд╛рдкреНрдд рдЖрд░рд╛рдо`
    },
    relatedDiseases: ["malaria", "dengue", "typhoid", "viral_infection"]
  },

  diarrhea: {
    name: {
      en: "Diarrhea",
      hi: "рджрд╕реНрдд",
      te: "р░Ер░др░┐р░╕р░╛р░░р░В"
    },
    symptoms: [
      "loose stools", "frequent bowel movements", "stomach cramps", 
      "nausea", "vomiting", "dehydration", "weakness"
    ],
    severity: "high",
    urgency: "immediate",
    advice: {
      en: `**Diarrhea Treatment:**
ЁЯТз **Critical: Prevent Dehydration**
тАв ORS solution every 15-20 minutes
тАв Coconut water, rice water, buttermilk
тАв Continue breastfeeding for infants

ЁЯНЪ **BRAT Diet:**
тАв Bananas, Rice, Applesauce, Toast
тАв Avoid dairy, spicy, fatty foods
тАв Small frequent meals

тЪая╕П **Emergency Signs:**
тАв Blood in stools
тАв High fever with diarrhea
тАв Signs of severe dehydration
тАв No urination for 8+ hours
тАв Extreme weakness

ЁЯПе **Seek immediate medical help if:**
тАв Infant under 6 months
тАв Elderly person affected
тАв Symptoms worsen after 24 hours`,
      hi: `**рджрд╕реНрдд рдХрд╛ рдЗрд▓рд╛рдЬ:**
ЁЯТз **рдорд╣рддреНрд╡рдкреВрд░реНрдг: рдирд┐рд░реНрдЬрд▓реАрдХрд░рдг рд░реЛрдХреЗрдВ**
тАв рд╣рд░ 15-20 рдорд┐рдирдЯ рдореЗрдВ ORS рдШреЛрд▓
тАв рдирд╛рд░рд┐рдпрд▓ рдкрд╛рдиреА, рдЪрд╛рд╡рд▓ рдХрд╛ рдкрд╛рдиреА, рдЫрд╛рдЫ
тАв рд╢рд┐рд╢реБрдУрдВ рдХреЗ рд▓рд┐рдП рд╕реНрддрдирдкрд╛рди рдЬрд╛рд░реА рд░рдЦреЗрдВ

ЁЯНЪ **BRAT рдЖрд╣рд╛рд░:**
тАв рдХреЗрд▓рд╛, рдЪрд╛рд╡рд▓, рд╕реЗрдм рдХреА рдкреНрдпреВрд░реА, рдЯреЛрд╕реНрдЯ
тАв рдбреЗрдпрд░реА, рдорд╕рд╛рд▓реЗрджрд╛рд░, рддреИрд▓реАрдп рднреЛрдЬрди рд╕реЗ рдмрдЪреЗрдВ
тАв рдереЛрдбрд╝рд╛-рдереЛрдбрд╝рд╛ рдХрд░рдХреЗ рдмрд╛рд░-рдмрд╛рд░ рдЦрд╛рдПрдВ

тЪая╕П **рдЖрдкрд╛рддрдХрд╛рд▓реАрди рд╕рдВрдХреЗрдд:**
тАв рдорд▓ рдореЗрдВ рдЦреВрди
тАв рджрд╕реНрдд рдХреЗ рд╕рд╛рде рддреЗрдЬ рдмреБрдЦрд╛рд░
тАв рдЧрдВрднреАрд░ рдирд┐рд░реНрдЬрд▓реАрдХрд░рдг рдХреЗ рд╕рдВрдХреЗрдд
тАв 8+ рдШрдВрдЯреЗ рддрдХ рдкреЗрд╢рд╛рдм рди рдЖрдирд╛
тАв рдЕрддреНрдпрдзрд┐рдХ рдХрдордЬреЛрд░реА

ЁЯПе **рддреБрд░рдВрдд рдЪрд┐рдХрд┐рддреНрд╕рд╛ рд╕рд╣рд╛рдпрддрд╛ рд▓реЗрдВ рдпрджрд┐:**
тАв 6 рдорд╣реАрдиреЗ рд╕реЗ рдХрдо рдХрд╛ рд╢рд┐рд╢реБ
тАв рдмреБрдЬреБрд░реНрдЧ рд╡реНрдпрдХреНрддрд┐ рдкреНрд░рднрд╛рд╡рд┐рдд
тАв 24 рдШрдВрдЯреЗ рдмрд╛рдж рд▓рдХреНрд╖рдг рдмрд┐рдЧрдбрд╝реЗрдВ`
    },
    relatedDiseases: ["cholera", "food_poisoning", "gastroenteritis"]
  },

  cough_cold: {
    name: {
      en: "Cough & Cold",
      hi: "рдЦрд╛рдВрд╕реА рдФрд░ рдЬреБрдХрд╛рдо",
      te: "р░жр░Чр▒Нр░Чр▒Б р░ор░░р░┐р░пр▒Б р░Ьр░▓р▒Бр░мр▒Б"
    },
    symptoms: [
      "runny nose", "sneezing", "cough", "sore throat", "mild fever",
      "congestion", "body ache", "fatigue"
    ],
    severity: "low",
    urgency: "monitor",
    advice: {
      en: `**Cough & Cold Care:**
ЁЯлЦ **Home Remedies:**
тАв Warm salt water gargling
тАв Honey and ginger tea
тАв Steam inhalation with tulsi leaves
тАв Turmeric milk before bed

ЁЯТз **Hydration:**
тАв Warm water, herbal teas
тАв Avoid cold drinks and ice
тАв Lemon honey water

тЪая╕П **See doctor if:**
тАв Fever above 101┬░F for 3+ days
тАв Difficulty breathing
тАв Chest pain or wheezing
тАв Cough with blood
тАв Symptoms worsen after a week

ЁЯЫбя╕П **Prevention:**
тАв Wash hands frequently
тАв Avoid close contact with sick people
тАв Cover mouth when coughing/sneezing
тАв Boost immunity with vitamin C foods`,
      hi: `**рдЦрд╛рдВрд╕реА рдФрд░ рдЬреБрдХрд╛рдо рдХреА рджреЗрдЦрднрд╛рд▓:**
ЁЯлЦ **рдШрд░реЗрд▓реВ рдЙрдкрдЪрд╛рд░:**
тАв рдЧреБрдирдЧреБрдиреЗ рдирдордХ рдХреЗ рдкрд╛рдиреА рд╕реЗ рдЧрд░рд╛рд░реЗ
тАв рд╢рд╣рдж рдФрд░ рдЕрджрд░рдХ рдХреА рдЪрд╛рдп
тАв рддреБрд▓рд╕реА рдХреЗ рдкрддреНрддреЛрдВ рдХреЗ рд╕рд╛рде рднрд╛рдк рд▓реЗрдирд╛
тАв рд╕реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд╣рд▓реНрджреА рд╡рд╛рд▓рд╛ рджреВрдз

ЁЯТз **рд╣рд╛рдЗрдбреНрд░реЗрд╢рди:**
тАв рдЧрд░реНрдо рдкрд╛рдиреА, рд╣рд░реНрдмрд▓ рдЪрд╛рдп
тАв рдардВрдбреЗ рдкреЗрдп рдФрд░ рдмрд░реНрдл рд╕реЗ рдмрдЪреЗрдВ
тАв рдиреАрдВрдмреВ рд╢рд╣рдж рдХрд╛ рдкрд╛рдиреА

тЪая╕П **рдбреЙрдХреНрдЯрд░ рд╕реЗ рдорд┐рд▓реЗрдВ рдпрджрд┐:**
тАв 3+ рджрд┐рди рддрдХ 101┬░F рд╕реЗ рдКрдкрд░ рдмреБрдЦрд╛рд░
тАв рд╕рд╛рдВрд╕ рд▓реЗрдиреЗ рдореЗрдВ рдХрдард┐рдирд╛рдИ
тАв рд╕реАрдиреЗ рдореЗрдВ рджрд░реНрдж рдпрд╛ рдШрд░рдШрд░рд╛рд╣рдЯ
тАв рдЦреВрди рдХреЗ рд╕рд╛рде рдЦрд╛рдВрд╕реА
тАв рдПрдХ рд╕рдкреНрддрд╛рд╣ рдмрд╛рдж рд▓рдХреНрд╖рдг рдмрд┐рдЧрдбрд╝реЗрдВ

ЁЯЫбя╕П **рд░реЛрдХрдерд╛рдо:**
тАв рдмрд╛рд░-рдмрд╛рд░ рд╣рд╛рде рдзреЛрдПрдВ
тАв рдмреАрдорд╛рд░ рд▓реЛрдЧреЛрдВ рд╕реЗ рджреВрд░реА рдмрдирд╛рдП рд░рдЦреЗрдВ
тАв рдЦрд╛рдВрд╕рддреЗ/рдЫреАрдВрдХрддреЗ рд╕рдордп рдореБрдВрд╣ рдврдХреЗрдВ
тАв рд╡рд┐рдЯрд╛рдорд┐рди рд╕реА рдпреБрдХреНрдд рдЦрд╛рджреНрдп рдкрджрд╛рд░реНрдереЛрдВ рд╕реЗ рд░реЛрдЧ рдкреНрд░рддрд┐рд░реЛрдзрдХ рдХреНрд╖рдорддрд╛ рдмрдврд╝рд╛рдПрдВ`
    },
    relatedDiseases: ["flu", "bronchitis", "pneumonia"]
  },

  malaria: {
    name: {
      en: "Malaria",
      hi: "рдорд▓реЗрд░рд┐рдпрд╛",
      te: "р░ор░▓р▒Зр░░р░┐р░пр░╛"
    },
    symptoms: [
      "high fever with chills", "sweating", "headache", "nausea", "vomiting",
      "muscle pain", "fatigue", "cyclical fever pattern"
    ],
    severity: "high",
    urgency: "immediate",
    advice: {
      en: `**Malaria - Medical Emergency:**
ЁЯЪи **Immediate Action Required:**
тАв Get blood test (RDT/microscopy) immediately
тАв Start treatment only after confirmation
тАв Do not delay medical consultation

ЁЯТК **Treatment:**
тАв Only take prescribed antimalarial drugs
тАв Complete full course even if feeling better
тАв Paracetamol for fever (not aspirin)

ЁЯЫбя╕П **Prevention (Critical for Rural Areas):**
тАв Use mosquito nets while sleeping
тАв Apply mosquito repellent
тАв Eliminate stagnant water around home
тАв Wear full-sleeve clothes in evening

тЪая╕П **Danger Signs:**
тАв Severe headache with neck stiffness
тАв Difficulty breathing
тАв Persistent vomiting
тАв Confusion or unconsciousness
тАв Dark/bloody urine

ЁЯПе **Seek immediate hospital care for danger signs**`,
      hi: `**рдорд▓реЗрд░рд┐рдпрд╛ - рдЪрд┐рдХрд┐рддреНрд╕рд╛ рдЖрдкрд╛рддрдХрд╛рд▓:**
ЁЯЪи **рддрддреНрдХрд╛рд▓ рдХрд╛рд░реНрд░рд╡рд╛рдИ рдЖрд╡рд╢реНрдпрдХ:**
тАв рддреБрд░рдВрдд рд░рдХреНрдд рдЬрд╛рдВрдЪ (RDT/рдорд╛рдЗрдХреНрд░реЛрд╕реНрдХреЛрдкреА) рдХрд░рд╛рдПрдВ
тАв рдкреБрд╖реНрдЯрд┐ рдХреЗ рдмрд╛рдж рд╣реА рдЗрд▓рд╛рдЬ рд╢реБрд░реВ рдХрд░реЗрдВ
тАв рдЪрд┐рдХрд┐рддреНрд╕рд╛ рд╕рд▓рд╛рд╣ рдореЗрдВ рджреЗрд░реА рди рдХрд░реЗрдВ

ЁЯТК **рдЙрдкрдЪрд╛рд░:**
тАв рдХреЗрд╡рд▓ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдорд▓реЗрд░рд┐рдпрд╛ рд░реЛрдзреА рджрд╡рд╛рдПрдВ рд▓реЗрдВ
тАв рдмреЗрд╣рддрд░ рдорд╣рд╕реВрд╕ рдХрд░рдиреЗ рдкрд░ рднреА рдкреВрд░рд╛ рдХреЛрд░реНрд╕ рд▓реЗрдВ
тАв рдмреБрдЦрд╛рд░ рдХреЗ рд▓рд┐рдП рдкреИрд░рд╛рд╕рд┐рдЯрд╛рдореЛрд▓ (рдПрд╕реНрдкрд┐рд░рд┐рди рдирд╣реАрдВ)

ЁЯЫбя╕П **рд░реЛрдХрдерд╛рдо (рдЧреНрд░рд╛рдореАрдг рдХреНрд╖реЗрддреНрд░реЛрдВ рдХреЗ рд▓рд┐рдП рдорд╣рддреНрд╡рдкреВрд░реНрдг):**
тАв рд╕реЛрддреЗ рд╕рдордп рдордЪреНрдЫрд░рджрд╛рдиреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ
тАв рдордЪреНрдЫрд░ рднрдЧрд╛рдиреЗ рд╡рд╛рд▓реА рдХреНрд░реАрдо рд▓рдЧрд╛рдПрдВ
тАв рдШрд░ рдХреЗ рдЖрд╕рдкрд╛рд╕ рд░реБрдХреЗ рд╣реБрдП рдкрд╛рдиреА рдХреЛ рд╣рдЯрд╛рдПрдВ
тАв рд╢рд╛рдо рдХреЛ рдкреВрд░реА рдмрд╛рдЬреВ рдХреЗ рдХрдкрдбрд╝реЗ рдкрд╣рдиреЗрдВ

тЪая╕П **рдЦрддрд░реЗ рдХреЗ рд╕рдВрдХреЗрдд:**
тАв рдЧрд░реНрджрди рдореЗрдВ рдЕрдХрдбрд╝рди рдХреЗ рд╕рд╛рде рдЧрдВрднреАрд░ рд╕рд┐рд░рджрд░реНрдж
тАв рд╕рд╛рдВрд╕ рд▓реЗрдиреЗ рдореЗрдВ рдХрдард┐рдирд╛рдИ
тАв рд▓рдЧрд╛рддрд╛рд░ рдЙрд▓реНрдЯреА
тАв рднреНрд░рдо рдпрд╛ рдмреЗрд╣реЛрд╢реА
тАв рдЧрд╣рд░реЗ/рдЦреВрдиреА рд░рдВрдЧ рдХрд╛ рдкреЗрд╢рд╛рдм

ЁЯПе **рдЦрддрд░реЗ рдХреЗ рд╕рдВрдХреЗрддреЛрдВ рдХреЗ рд▓рд┐рдП рддреБрд░рдВрдд рдЕрд╕реНрдкрддрд╛рд▓ рдЬрд╛рдПрдВ**`
    },
    relatedDiseases: ["dengue", "chikungunya", "typhoid"]
  },

  dengue: {
    name: {
      en: "Dengue Fever",
      hi: "рдбреЗрдВрдЧреВ рдмреБрдЦрд╛рд░",
      te: "р░бр▒Жр░Вр░Чр▒Нр░пр▒В р░Ьр▒Нр░╡р░░р░В"
    },
    symptoms: [
      "sudden high fever", "severe headache", "eye pain", "muscle pain",
      "joint pain", "skin rash", "nausea", "vomiting"
    ],
    severity: "high",
    urgency: "immediate",
    advice: {
      en: `**Dengue - Serious Viral Disease:**
ЁЯЪи **Immediate Medical Attention Required**
тАв Get blood test (NS1, IgM/IgG) immediately
тАв Monitor platelet count daily
тАв No self-medication

ЁЯТз **Critical Care:**
тАв Increase fluid intake significantly
тАв ORS, coconut water, fresh juices
тАв Paracetamol ONLY for fever
тАв NEVER give aspirin or ibuprofen

тЪая╕П **Danger Signs (Emergency):**
тАв Severe abdominal pain
тАв Persistent vomiting
тАв Bleeding (nose, gums, skin)
тАв Difficulty breathing
тАв Sudden drop in temperature with sweating
тАв Restlessness or drowsiness

ЁЯЫбя╕П **Prevention:**
тАв Eliminate standing water (pots, tires, containers)
тАв Use mosquito nets and repellents
тАв Keep surroundings clean
тАв Community-wide mosquito control

ЁЯПе **Hospitalization may be needed for severe cases**`,
      hi: `**рдбреЗрдВрдЧреВ - рдЧрдВрднреАрд░ рд╡рд╛рдпрд░рд▓ рдмреАрдорд╛рд░реА:**
ЁЯЪи **рддрддреНрдХрд╛рд▓ рдЪрд┐рдХрд┐рддреНрд╕рд╛ рд╕рд╣рд╛рдпрддрд╛ рдЖрд╡рд╢реНрдпрдХ**
тАв рддреБрд░рдВрдд рд░рдХреНрдд рдЬрд╛рдВрдЪ (NS1, IgM/IgG) рдХрд░рд╛рдПрдВ
тАв рд░реЛрдЬрд╛рдирд╛ рдкреНрд▓реЗрдЯрд▓реЗрдЯ рдХрд╛рдЙрдВрдЯ рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХрд░реЗрдВ
тАв рд╕реНрд╡-рдЪрд┐рдХрд┐рддреНрд╕рд╛ рди рдХрд░реЗрдВ

ЁЯТз **рдорд╣рддреНрд╡рдкреВрд░реНрдг рджреЗрдЦрднрд╛рд▓:**
тАв рддрд░рд▓ рдкрджрд╛рд░реНрде рдХрд╛ рд╕реЗрд╡рди рдХрд╛рдлреА рдмрдврд╝рд╛рдПрдВ
тАв ORS, рдирд╛рд░рд┐рдпрд▓ рдкрд╛рдиреА, рддрд╛рдЬреЗ рдЬреВрд╕
тАв рдмреБрдЦрд╛рд░ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рдкреИрд░рд╛рд╕рд┐рдЯрд╛рдореЛрд▓
тАв рдХрднреА рднреА рдПрд╕реНрдкрд┐рд░рд┐рди рдпрд╛ рдЖрдЗрдмреБрдкреНрд░реЛрдлреЗрди рди рджреЗрдВ

тЪая╕П **рдЦрддрд░реЗ рдХреЗ рд╕рдВрдХреЗрдд (рдЖрдкрд╛рддрдХрд╛рд▓):**
тАв рдкреЗрдЯ рдореЗрдВ рддреЗрдЬ рджрд░реНрдж
тАв рд▓рдЧрд╛рддрд╛рд░ рдЙрд▓реНрдЯреА
тАв рд░рдХреНрддрд╕реНрд░рд╛рд╡ (рдирд╛рдХ, рдорд╕реВрдбрд╝реЗ, рддреНрд╡рдЪрд╛)
тАв рд╕рд╛рдВрд╕ рд▓реЗрдиреЗ рдореЗрдВ рдХрдард┐рдирд╛рдИ
тАв рдкрд╕реАрдиреЗ рдХреЗ рд╕рд╛рде рддрд╛рдкрдорд╛рди рдореЗрдВ рдЕрдЪрд╛рдирдХ рдЧрд┐рд░рд╛рд╡рдЯ
тАв рдмреЗрдЪреИрдиреА рдпрд╛ рд╕реБрд╕реНрддреА

ЁЯЫбя╕П **рд░реЛрдХрдерд╛рдо:**
тАв рд░реБрдХреЗ рд╣реБрдП рдкрд╛рдиреА рдХреЛ рд╣рдЯрд╛рдПрдВ (рдмрд░реНрддрди, рдЯрд╛рдпрд░, рдХрдВрдЯреЗрдирд░)
тАв рдордЪреНрдЫрд░рджрд╛рдиреА рдФрд░ рд░рд┐рдкреЗрд▓реЗрдВрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ
тАв рдЖрд╕рдкрд╛рд╕ рдХреА рд╕рдлрд╛рдИ рд░рдЦреЗрдВ
тАв рд╕рдореБрджрд╛рдпрд┐рдХ рд╕реНрддрд░ рдкрд░ рдордЪреНрдЫрд░ рдирд┐рдпрдВрддреНрд░рдг

ЁЯПе **рдЧрдВрднреАрд░ рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдЕрд╕реНрдкрддрд╛рд▓ рдореЗрдВ рднрд░реНрддреА рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ**`
    },
    relatedDiseases: ["malaria", "chikungunya", "zika"]
  }
};

// Symptom analysis function
const analyzeSymptoms = (symptoms, language = 'en') => {
  const inputSymptoms = symptoms.toLowerCase().split(/[,\s]+/).filter(s => s.length > 2);
  const matches = [];
  
  for (const [diseaseKey, disease] of Object.entries(diseaseDatabase)) {
    let matchCount = 0;
    let matchedSymptoms = [];
    
    for (const symptom of disease.symptoms) {
      for (const inputSymptom of inputSymptoms) {
        if (symptom.includes(inputSymptom) || inputSymptom.includes(symptom)) {
          matchCount++;
          matchedSymptoms.push(symptom);
          break;
        }
      }
    }
    
    if (matchCount > 0) {
      matches.push({
        disease: diseaseKey,
        name: disease.name[language] || disease.name.en,
        matchCount,
        matchedSymptoms,
        severity: disease.severity,
        urgency: disease.urgency,
        advice: disease.advice[language] || disease.advice.en,
        confidence: Math.round((matchCount / disease.symptoms.length) * 100)
      });
    }
  }
  
  return matches.sort((a, b) => b.matchCount - a.matchCount);
};

// Get disease information
const getDiseaseInfo = (diseaseKey, language = 'en') => {
  const disease = diseaseDatabase[diseaseKey];
  if (!disease) return null;
  
  return {
    name: disease.name[language] || disease.name.en,
    symptoms: disease.symptoms,
    severity: disease.severity,
    urgency: disease.urgency,
    advice: disease.advice[language] || disease.advice.en,
    relatedDiseases: disease.relatedDiseases
  };
};

// Generate symptom checker response
const generateSymptomAnalysis = (symptoms, language = 'en') => {
  const analysis = analyzeSymptoms(symptoms, language);
  
  if (analysis.length === 0) {
    const noMatchTexts = {
      en: `I couldn't identify specific diseases from the symptoms you described. 

ЁЯПе **General Advice:**
тАв Monitor your symptoms closely
тАв Stay hydrated and rest
тАв Consult a healthcare provider if symptoms persist
тАв Seek immediate help if symptoms worsen

Please describe your symptoms in more detail or consult a doctor for proper diagnosis.`,
      hi: `рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдмрддрд╛рдП рдЧрдП рд▓рдХреНрд╖рдгреЛрдВ рд╕реЗ рдореИрдВ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдмреАрдорд╛рд░рд┐рдпреЛрдВ рдХреА рдкрд╣рдЪрд╛рди рдирд╣реАрдВ рдХрд░ рд╕рдХрд╛ред

ЁЯПе **рд╕рд╛рдорд╛рдиреНрдп рд╕рд▓рд╛рд╣:**
тАв рдЕрдкрдиреЗ рд▓рдХреНрд╖рдгреЛрдВ рдкрд░ рдмрд╛рд░реАрдХреА рд╕реЗ рдирдЬрд░ рд░рдЦреЗрдВ
тАв рд╣рд╛рдЗрдбреНрд░реЗрдЯреЗрдб рд░рд╣реЗрдВ рдФрд░ рдЖрд░рд╛рдо рдХрд░реЗрдВ
тАв рдпрджрд┐ рд▓рдХреНрд╖рдг рдмрдиреЗ рд░рд╣реЗрдВ рддреЛ рд╕реНрд╡рд╛рд╕реНрдереНрдп рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рд╕реЗ рд╕рд▓рд╛рд╣ рд▓реЗрдВ
тАв рдпрджрд┐ рд▓рдХреНрд╖рдг рдмрд┐рдЧрдбрд╝реЗрдВ рддреЛ рддреБрд░рдВрдд рд╕рд╣рд╛рдпрддрд╛ рд▓реЗрдВ

рдХреГрдкрдпрд╛ рдЕрдкрдиреЗ рд▓рдХреНрд╖рдгреЛрдВ рдХрд╛ рдЕрдзрд┐рдХ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рд╡рд░реНрдгрди рдХрд░реЗрдВ рдпрд╛ рдЙрдЪрд┐рдд рдирд┐рджрд╛рди рдХреЗ рд▓рд┐рдП рдбреЙрдХреНрдЯрд░ рд╕реЗ рд╕рд▓рд╛рд╣ рд▓реЗрдВред`
    };
    
    return noMatchTexts[language] || noMatchTexts.en;
  }
  
  const topMatch = analysis[0];
  const urgencyTexts = {
    en: {
      immediate: "ЁЯЪи **URGENT - Seek immediate medical attention**",
      monitor: "тЪая╕П **Monitor closely - See doctor if symptoms worsen**",
      routine: "ЁЯУЛ **Routine care - Schedule doctor visit**"
    },
    hi: {
      immediate: "ЁЯЪи **рддрддреНрдХрд╛рд▓ - рддреБрд░рдВрдд рдЪрд┐рдХрд┐рддреНрд╕рд╛ рд╕рд╣рд╛рдпрддрд╛ рд▓реЗрдВ**",
      monitor: "тЪая╕П **рдмрд╛рд░реАрдХреА рд╕реЗ рдирд┐рдЧрд░рд╛рдиреА рдХрд░реЗрдВ - рдпрджрд┐ рд▓рдХреНрд╖рдг рдмрд┐рдЧрдбрд╝реЗрдВ рддреЛ рдбреЙрдХреНрдЯрд░ рд╕реЗ рдорд┐рд▓реЗрдВ**",
      routine: "ЁЯУЛ **рдирд┐рдпрдорд┐рдд рджреЗрдЦрднрд╛рд▓ - рдбреЙрдХреНрдЯрд░ рд╕реЗ рдорд┐рд▓рдиреЗ рдХрд╛ рд╕рдордп рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдВ**"
    }
  };
  
  const urgencyText = urgencyTexts[language] || urgencyTexts.en;
  
  let response = `**Possible Condition: ${topMatch.name}**\n`;
  response += `**Confidence: ${topMatch.confidence}%**\n\n`;
  response += `${urgencyText[topMatch.urgency]}\n\n`;
  response += `${topMatch.advice}\n\n`;
  
  if (analysis.length > 1) {
    const otherTexts = {
      en: "**Other possible conditions to consider:**",
      hi: "**рд╡рд┐рдЪрд╛рд░ рдХрд░рдиреЗ рдпреЛрдЧреНрдп рдЕрдиреНрдп рд╕рдВрднрд╛рд╡рд┐рдд рд╕реНрдерд┐рддрд┐рдпрд╛рдВ:**"
    };
    
    response += `${otherTexts[language] || otherTexts.en}\n`;
    for (let i = 1; i < Math.min(3, analysis.length); i++) {
      response += `тАв ${analysis[i].name} (${analysis[i].confidence}%)\n`;
    }
  }
  
  const disclaimerTexts = {
    en: "\nтЪая╕П **Disclaimer:** This is not a medical diagnosis. Always consult a qualified healthcare provider for proper diagnosis and treatment.",
    hi: "\nтЪая╕П **рдЕрд╕реНрд╡реАрдХрд░рдг:** рдпрд╣ рдЪрд┐рдХрд┐рддреНрд╕рд╛ рдирд┐рджрд╛рди рдирд╣реАрдВ рд╣реИред рдЙрдЪрд┐рдд рдирд┐рджрд╛рди рдФрд░ рдЙрдкрдЪрд╛рд░ рдХреЗ рд▓рд┐рдП рд╣рдореЗрд╢рд╛ рдПрдХ рдпреЛрдЧреНрдп рд╕реНрд╡рд╛рд╕реНрдереНрдп рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рд╕реЗ рд╕рд▓рд╛рд╣ рд▓реЗрдВред"
  };
  
  response += disclaimerTexts[language] || disclaimerTexts.en;
  
  return response;
};

// Emergency symptom detection
const detectEmergencySymptoms = (symptoms) => {
  const emergencyKeywords = [
    'chest pain', 'difficulty breathing', 'unconscious', 'severe bleeding',
    'high fever', 'severe headache', 'vomiting blood', 'severe abdominal pain',
    'stroke symptoms', 'heart attack', 'seizure', 'severe dehydration'
  ];
  
  const lowerSymptoms = symptoms.toLowerCase();
  return emergencyKeywords.some(keyword => lowerSymptoms.includes(keyword));
};

module.exports = {
  analyzeSymptoms,
  getDiseaseInfo,
  generateSymptomAnalysis,
  detectEmergencySymptoms,
  diseaseDatabase
};
